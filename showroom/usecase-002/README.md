# ユースケース 002: 複数の入力テキストによる応答生成

このユースケースでは、OpenAI Responses APIの複数入力テキスト（メッセージ）機能を使用して、
会話の文脈や複数のドキュメントを考慮した応答を生成する方法を紹介します。

## 概要

Responses APIでは、`input`パラメータに複数のメッセージを配列として渡すことができます。これにより：

- 会話の履歴を含めた文脈を提供できる
- 複数のドキュメントや情報源を同時に処理できる
- 複雑なタスクを段階的に指示できる

このサンプルでは、以下の3つのケースを示します：

1. **単純な会話**: ユーザーとアシスタントの会話履歴を含め、文脈を考慮した応答を生成
2. **テキスト要約タスク**: 長い説明テキストと要約指示を別々の入力として提供
3. **複数の文書比較分析**: 2つの製品仕様書を比較して表形式での違いをまとめるタスク

## 実行方法

1. プロジェクトのルートディレクトリに`.env`ファイルを作成し、OpenAI APIキーを設定します：

```
OPENAI_API_KEY=your_api_key_here
```

2. 必要なパッケージをインストールします：

```bash
pip install -r requirements.txt
```

3. スクリプトを実行します：

```bash
python main.py
```

## コード説明

`main.py`は以下の主要な機能で構成されています：

1. **環境設定**: .envファイルからAPIキーを読み込み環境を設定
2. **メッセージ作成関数**: 適切な形式でメッセージオブジェクトを作成
3. **複数ケースの定義**: 異なる応用シナリオを示す3つのケースを定義
4. **応答生成**: 各ケースで複数入力を使用してOpenAI Responses APIを呼び出し
5. **結果表示**: 各ケースの会話履歴と生成された応答を表示

## 入力メッセージの構造

Responses APIへの複数入力は、以下の形式で構造化されます：

```python
input = [
    {
        "type": "message",
        "role": "user",  # または "assistant"
        "content": [
            {
                "type": "input_text",  # userの場合
                "text": "メッセージの内容"
            }
        ]
    },
    # 追加のメッセージ...
]
```

## 主なユースケース

複数入力テキストによる応答生成は、以下のようなシナリオで特に効果的です：

1. **会話型アプリケーション**: 過去の会話履歴を含めることで文脈に沿った応答が可能
2. **複合ドキュメント分析**: 複数のドキュメントを同時に処理し、比較や要約が可能
3. **段階的なタスク指示**: 基本タスクと詳細指示を分けて提供できる
4. **知識の組み合わせ**: 異なる情報源からのデータを組み合わせて応答を生成
5. **ロールプレイングシナリオ**: ユーザーとアシスタントの役割を交互に入力し、会話をシミュレート

## 発展的な応用例

- **マルチドキュメント要約**: 複数の記事やレポートから重要ポイントを抽出
- **Q&A システム**: 複数の関連コンテキストを提供して精度の高い回答を生成
- **インタラクティブチュートリアル**: 前のステップに基づいて次のステップを説明
- **コンテンツ作成支援**: 複数の参考資料を元にしたコンテンツの作成
- **会話型エージェント**: 継続的な会話履歴を保持するチャットボットシステム

## 注意点

- 入力トークン数が多くなるため、コスト管理に注意が必要です
- モデルの最大コンテキスト長を超えないよう、入力の総量に注意してください
- 入力の順序が重要であり、メッセージの配置が応答に影響します

## 参考資料

- [OpenAI Responses API ドキュメント](https://platform.openai.com/docs/api-reference/responses)
- [Responses APIの入力形式](https://platform.openai.com/docs/api-reference/responses/object)